geom_bar(position="fill", stat="identity")+
coord_flip()+theme(axis.text.y=element_blank())
plot_dt <- plot_dt[order(plot_dt$nn_construction_age_band),]
plot_dt <- plot_dt[c(11, seq(1,10,1),12),]
levels(plot_dt$nn_construction_age_band) <- c(plot_dt$nn_construction_age_band)
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n)) +
geom_bar(stat='identity')+
coord_flip()
levels(plot_dt$nn_construction_age_band)
levels(plot_dt$nn_construction_age_band) <- c(plot_dt$nn_construction_age_band)
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n)) +
geom_bar(stat='identity')+
coord_flip()
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n)) +
geom_bar(stat='identity')+
coord_flip()
plot_dt$nn_construction_age_band
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n)) +
geom_bar(stat='identity')+
scale_x_discrete(limits= plot_dt$nn_construction_age_band)+
coord_flip()
factor(plot_dt$nn_construction_age_band, c(plot_dt$nn_construction_age_band))
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n)) +
geom_bar(stat='identity')+
coord_flip()
c(plot_dt$nn_construction_age_band)
plot_dt[,setattr(nn_construction_age_band,c(plot_dt$nn_construction_age_band))]
plot_dt[,setattr(nn_construction_age_band,'levels',c(plot_dt$nn_construction_age_band))]
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n)) +
geom_bar(stat='identity')+
coord_flip()
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n))
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n))+
geom_bar(stat='identity')+
coord_flip()
c(plot_dt$nn_construction_age_band)
big_Dt[,setattr(nn_construction_age_band,'levels',fctr_levels)]
fctr_levels <- c("Pre-1900","1900-1929","1930-1949","1950-1966","1967-1975","1976-1982","1983-1990","1991-1995","1996-2002","2003-2006","2007 onwards","unknown")
big_Dt[,setattr(nn_construction_age_band,'levels',fctr_levels)]
level(big_Dt$nn_construction_age_band)
levels(big_Dt$nn_construction_age_band)
big_Dt<- big_Dt[,setattr(nn_construction_age_band,'levels',fctr_levels)]
# Stacked + percent
plot_dt <- big_Dt[ , by = 'nn_construction_age_band',
.(n = .N)]
# Stacked + percent
plot_dt <- big_Dt[ , by = 'nn_construction_age_band',
.(n = .N)]
rm(list = ls())
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(data.table)
library(readxl)
library(readr)
loadRData <- function(fileName){
#loads an RData file, and returns it
load(fileName)
get(ls()[ls() != "fileName"])
}
#get folders
cross_data <- list.files(path = "../Data/RData_crossSectional", pattern = NULL, all.files = FALSE,
full.names = FALSE, recursive = FALSE,
ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)
cross_data <- gsub(".RData","",as.character(cross_data))
cross_data <- gsub("crossSectional_","",as.character(cross_data))
EDA_cols <- read_csv("../Data/EDA_colour_scheme.csv")
EDA_cols <- subset(EDA_cols[EDA_cols$geography_name %in%  cross_data, ])
#formatting:
lettermapping <-  data.frame( letter = c('A','B','C','D','E','F','G'),
cutoff = c(92, 81, 69, 55, 39, 21, 0))
big_Dt <- data.table()
for (WIP in EDA_cols$geography_name) {
if(WIP == "Unknown") break;
region_df <- loadRData(paste0("../Outputs/WIP_crossSectional/ONSUD_crossSectional_baseline_",WIP,".RData") )
region_df$CURRENT_ENERGY_EFFICIENCY <- as.numeric(region_df$CURRENT_ENERGY_EFFICIENCY)
region_df$regionName
big_Dt <- rbindlist(list(big_Dt,region_df))
}
#resolve age:
big_Dt <- big_Dt[, nn_construction_age_band := n_construction_age_band]
big_Dt <- big_Dt[n_construction_age_band == '2012 onwards' | n_construction_age_band =='2007-2011', nn_construction_age_band := '2007 onwards']
big_Dt <- big_Dt[n_construction_age_band == 'Not applicable', nn_construction_age_band := 'unknown']
fctr_levels <- c("Pre-1900","1900-1929","1930-1949","1950-1966","1967-1975","1976-1982","1983-1990","1991-1995","1996-2002","2003-2006","2007 onwards","unknown")
invisible(big_Dt[,setattr(nn_construction_age_band,'levels',fctr_levels)])#avoid massive print
ggplot(big_Dt, aes(x=nn_construction_age_band, y=n))+
geom_bar(stat='identity')+
coord_flip()
ggplot(big_Dt, aes(x=nn_construction_age_band, y=n))+
geom_bar(stat='identity')+
coord_flip()
plot_dt <- big_Dt[ , by = 'nn_construction_age_band',
.(n = .N)]
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n))+
geom_bar(stat='identity')+
coord_flip()
sample <-big_Dt[sample( x= nrow(big_Dt), size = 9000, replace = F),]
ggplot(sample, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = n_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)
+
scale_color_manual(values = EDA_cols$colour,
labels = EDA_cols$geography_name)
ggplot(sample, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)
big_Dt[,(nn_construction_age_band) := factor(get(nn_construction_age_band), levels = fctr_levels, ordered = T)]
#resolve age:
big_Dt <- big_Dt[, nn_construction_age_band := n_construction_age_band]
big_Dt <- big_Dt[n_construction_age_band == '2012 onwards' | n_construction_age_band =='2007-2011', nn_construction_age_band := '2007 onwards']
big_Dt <- big_Dt[n_construction_age_band == 'Not applicable', nn_construction_age_band := 'unknown']
fctr_levels <- c("Pre-1900","1900-1929","1930-1949","1950-1966","1967-1975","1976-1982","1983-1990","1991-1995","1996-2002","2003-2006","2007 onwards","unknown")
big_Dt[,(nn_construction_age_band) := factor(get(nn_construction_age_band), levels = fctr_levels, ordered = T)]
big_Dt[,nn_construction_age_band := factor(get(nn_construction_age_band), levels = fctr_levels, ordered = T)]
big_Dt[,(nn_construction_age_band) := factor(nn_construction_age_band, levels = fctr_levels, ordered = T)]
head(factor(nn_construction_age_band, levels = fctr_levels, ordered = T))
big_Dt[,nn_construction_age_band := factor(get(nn_construction_age_band), levels = fctr_levels, ordered = T)]
fctr_levels
big_Dt[,nn_construction_age_band := factor(get(nn_construction_age_band), levels = fctr_levels, ordered = T)]
big_Dt[,nn_construction_age_band := factor(nn_construction_age_band, levels = fctr_levels, ordered = T)]
plot_dt <- big_Dt[ , by = 'nn_construction_age_band',  .(n = .N)]
ggplot(plot_dt, aes(x=nn_construction_age_band, y=n))+
geom_bar(stat='identity')+
coord_flip()
sample <-big_Dt[sample( x= nrow(big_Dt), size = 9000, replace = F),]
ggplot(sample, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)
+
scale_color_manual(values = EDA_cols$colour,
labels = EDA_cols$geography_name)
big_Dt[,n_difference_potential := POTENTIAL_ENERGY_EFFICIENCY - CURRENT_ENERGY_EFFICIENCY]
ggplot(sample, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)+
big_Dt[,n_difference_potential := POTENTIAL_ENERGY_EFFICIENCY - CURRENT_ENERGY_EFFICIENCY]
ggplot(sample, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)
ggplot(sample, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)
ggplot(sample, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)
ggplot(sample, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1, trim = T)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1, from = 0, to = 100)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
max(big_Dt$CURRENT_ENERGY_EFFICIENCY)
View(big_Dt[CURRENT_ENERGY_EFFICIENCY>100,])
lengths(big_Dt[CURRENT_ENERGY_EFFICIENCY>100,])
3270/lengths(big_Dt[1])
3270/lengths(big_Dt[1])
lengths(big_Dt[1])
lengths(big_Dt)
3270/17233689
3270/17233689*100
ggplot(big_Dt, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff, limits = c(0,100))
big_Dt[,nn_CURRENT_ENERGY_EFFICIENCY := CURRENT_ENERGY_EFFICIENCY]
big_Dt[CURRENT_ENERGY_EFFICIENCY > 101, nn_CURRENT_ENERGY_EFFICIENCY := NA]
big_Dt[,nn_CURRENT_ENERGY_EFFICIENCY := CURRENT_ENERGY_EFFICIENCY]
big_Dt[CURRENT_ENERGY_EFFICIENCY > 101, nn_CURRENT_ENERGY_EFFICIENCY := NA]
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
ggplot(big_Dt, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
ggplot(big_Dt, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band),position="identity",geom="line") +
stat_density(lwd = 1.2, linetype = 1)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1, position="identity",geom="line")+
#stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line")+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = "ucv")+
#stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line")+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
geom_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
#stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line")+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
#geom_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
big_Dt[,n_difference_potential := POTENTIAL_ENERGY_EFFICIENCY - nn_CURRENT_ENERGY_EFFICIENCY]
ggplot(big_Dt, aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt, aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)
big_Dt[CURRENT_ENERGY_EFFICIENCY > 101 & POTENTIAL_ENERGY_EFFICIENCY > 101,
n_difference_potential := POTENTIAL_ENERGY_EFFICIENCY - nn_CURRENT_ENERGY_EFFICIENCY]
ggplot(big_Dt, aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)
big_Dt[,nn_CURRENT_ENERGY_EFFICIENCY := CURRENT_ENERGY_EFFICIENCY]
big_Dt[CURRENT_ENERGY_EFFICIENCY > 101, nn_CURRENT_ENERGY_EFFICIENCY := NA]
ggplot(big_Dt, aes(x = nn_CURRENT_ENERGY_EFFICIENCY, colour = nn_construction_age_band)) +
#geom_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
geom_vline( xintercept =  lettermapping$cutoff, colour = 'grey', size=.6)+
annotate("text",x = lettermapping$cutoff+5, y= 0.1, label=lettermapping$letter, angle=90, size=5)+
#theme_classic() +
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
scale_x_continuous(name = 'Current Energy Efficiency' , breaks= lettermapping$cutoff)
ggplot(big_Dt [n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)
min(big_Dt$n_difference_potential)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))
big_Dt[CURRENT_ENERGY_EFFICIENCY > 101 & POTENTIAL_ENERGY_EFFICIENCY > 101,
n_difference_potential := POTENTIAL_ENERGY_EFFICIENCY - nn_CURRENT_ENERGY_EFFICIENCY]
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Potential Energy Efficiency Pts Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')
#idea here is to see if how much potential surveyors think there is by building type. But not all changes will change the letter rating
big_Dt[CURRENT_ENERGY_EFFICIENCY > 101 & POTENTIAL_ENERGY_EFFICIENCY > 101,
n_difference_potential := POTENTIAL_ENERGY_EFFICIENCY - nn_CURRENT_ENERGY_EFFICIENCY]
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Potential Energy Efficiency Pts Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 21, y= 0.1, label='Threashold for at least one letter change', angle=90, size=5)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Potential Energy Efficiency Pts Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 21, y= 0, label='Threashold for rating letter change', angle=90, size=2)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Potential Energy Efficiency Pts Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 21.3, y= 0.03, label='Threashold for at least one rating letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 21.3, y= 0.1, label='Threashold for at least one rating letter change', angle=90, size=3)
#idea here is to see if how much potential surveyors think there is by building type. But not all changes will change the letter rating
big_Dt[CURRENT_ENERGY_EFFICIENCY > 101 & POTENTIAL_ENERGY_EFFICIENCY > 101,
n_difference_potential := POTENTIAL_ENERGY_EFFICIENCY - nn_CURRENT_ENERGY_EFFICIENCY]
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.01, label='Threashold for at least one rating letter change', angle=90, size=3)
#idea here is to see if how much potential surveyors think there is by building type. But not all changes will change the letter rating
big_Dt[CURRENT_ENERGY_EFFICIENCY > 101 & POTENTIAL_ENERGY_EFFICIENCY > 101,
n_difference_potential := POTENTIAL_ENERGY_EFFICIENCY - nn_CURRENT_ENERGY_EFFICIENCY]
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.01, label='Threashold for at least one letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.09, label='Threashold for at least one letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.03, label='Threashold for at least one letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.03, label='Threashold for at least one letter change', angle=0, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.04, label='Threashold for at least one letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.047, label='Threashold for at least one letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.047, label='Threashold for at least one letter change', angle=90, size=3.4)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.047, label='Threashold for at least one letter change', angle=, size=3.4)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 0.047, label='Threashold for at least one letter change', angle=0, size=3.4)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= 3, label='Threashold for at least one letter change', angle=0, size=3.4)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= .9, label='Threashold for at least one letter change', angle=0, size=3.4)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= .09, label='Threashold for at least one letter change', angle=0, size=3.4)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= .099, label='Threashold for at least one letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= .039, label='Threashold for sure letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= .07, label='Threashold for sure letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= .06, label='Threashold for sure letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  21, colour = 'black', size=.6)+
annotate("text",x = 23, y= .066, label='Threashold for sure letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential>= 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  20, colour = 'black', size=.6)+
annotate("text",x = 23, y= .066, label='Threashold for sure letter change', angle=90, size=3)
ggplot(big_Dt [n_difference_potential> 0 & n_difference_potential < 100], aes(x = n_difference_potential, colour = nn_construction_age_band)) +
stat_density(lwd = 1.2, linetype = 1, position="identity",geom="line", bw = 2)+
scale_x_continuous(name = 'Est. Potential Energy Efficiency Improvement' , breaks= seq(0,100,10))+
theme_minimal()+
theme(legend.position = 'bottom', legend.box = 'horizontal')+
geom_vline( xintercept =  20, colour = 'black', size=.6)+
annotate("text",x = 23, y= .066, label='Threashold for sure letter change', angle=90, size=3)
